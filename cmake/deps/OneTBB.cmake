set(TBB_TEST OFF CACHE BOOL "" FORCE)
set(TBB_STRICT OFF CACHE BOOL "" FORCE)
cmake_path(APPEND CODEX_THIRDPARTY_CACHE_DIR "${CODEX_ONETBB_ARCHIVE}" OUTPUT_VARIABLE _onetbb_archive)
set(_onetbb_url "${CODEX_ONETBB_URL}")
if(EXISTS "${_onetbb_archive}")
    file(TO_CMAKE_PATH "${_onetbb_archive}" _onetbb_archive_norm)
    set(_onetbb_url "file://${_onetbb_archive_norm}")
endif()
FetchContent_Declare(oneTBB
    URL ${_onetbb_url}
    URL_HASH SHA256=${CODEX_ONETBB_SHA256}
)
FetchContent_GetProperties(oneTBB)
if(NOT oneTBB_POPULATED)
    FetchContent_Populate(oneTBB)
    FetchContent_GetProperties(oneTBB)
endif()
if(NOT DEFINED oneTBB_SOURCE_DIR AND DEFINED onetbb_SOURCE_DIR)
    set(oneTBB_SOURCE_DIR "${onetbb_SOURCE_DIR}")
endif()
if(NOT DEFINED oneTBB_BINARY_DIR AND DEFINED onetbb_BINARY_DIR)
    set(oneTBB_BINARY_DIR "${onetbb_BINARY_DIR}")
endif()
add_subdirectory(${oneTBB_SOURCE_DIR} ${oneTBB_BINARY_DIR})
unset(_onetbb_archive)
unset(_onetbb_archive_norm)
unset(_onetbb_url)
